{% extends "core/base.html" %}

{% block heading %}Lyfe User Information: {{ lyfeuser.username }}{% endblock %}

{% block content %}
{% load extras %}
{% if addfriend %}
<a href="{% url 'core.views.addfriend' lyfeuser.username %}">+ Add Friend/Follow</a>
{% elif lyfeuser.username != user.username %}
<a href="{% url 'core.views.unfriend' lyfeuser.username %}">- Unfriend/Unfollow</a>
{% endif %}

    <h3>PROFILE INFORMATION</h3>
    <ul>
    <li>Points: {{ lyfeuser.cur_points }} / {{ lyfeuser.total_points }}</li>
    <li>Last active date? {{ lyfeuser.last_active_date }}</li>
    <li>Last Friend Points Given: {{ lyfeuser.last_fp_given }}</li>
    <li>Avatar: <br>
    <img src="{{ lyfeuser.avatar.url }}" /></li>
    </ul>
    
    <h3>GOALS</h3>
    <ul>
    {% for goalgroup, groupgoals in goals.items %}
        <li>{{ goalgroup }}
        <ul>
            {% for goal in groupgoals %}
                <li><span class="{{goal.get_status_display}}"><b>{{ goal }}</b></span> ({{goal.get_status_display}})
                
                {% if goal.status == 0 %}
                    {% if friendpoints %} | <a href = "{% url 'core.views.add_friendpoint' goal.pk %}">+ Add Friend Point</a>{% endif %}
                {% endif %} | <b>Progress Updates</b>
                
                <br>
                Base Points: {{ goal.base_points }} | Friend Points: {{ goal.friend_points }} | Time Points: {{ goal.time_points }}<br>
                Start Date: {{ goal.start_date }} | Completion Date: {{ goal.completion_date }}
            {% endfor %}
        </ul>
    {% endfor %}
    </ul>
    
    <h3>NEWSFEED</h3>
    <h5>FRIENDS</h5>
    {% if friends %}
        {% for friend in friends %}
            <a href = "{% url 'core.views.profile' friend.recipient_id %}"><img src = "{{friend.recipient_id|user_avatar_url}}"></a>
        {% endfor %}
        {% else %}
        No friends :(
    {% endif %}
    <br><br>
    <ul>
        {% for update in newsfeed %}
            <li> {{ update.user_id }} {% if update.completion %} completed {% else %} posted an update to {% endif %} goal <b>{{ update.goal_id }}</b> in category <i>{{ update.goal_id.goal_id }}</i> | {{ update.timestamp }}<br>
            {{ update.content }}
            <br>
        {% endfor %}
    </ul>
<br/>
<br/>
<a href="{% url 'core.views.dashboard' %}">dashboard</a>
</p>

{% endblock %}
